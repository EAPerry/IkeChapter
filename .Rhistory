mod8$coefficients["treatment:tpost_D"],
mod9$coefficients["treatment:tpost_D"]
)
term_names <- data.frame(summary(mod1)$aliased)
term_names <- rownames(term_names)
main_se <- lapply(my_SE, function (x) data.frame(term_names, x))
main_se <- bind_rows(main_se)
main_se <- main_se %>%
filter(term_names == "treatment:tpost_D")
main_se <- main_se$x
out_df <- data.frame(model_num, panel_type, outcome, main_coefs, main_se)
colnames(out_df) <- c("model","panel","outcome","coefs","se")
out_df <- out_df %>%
mutate(
lower_CI = coefs - 1.96*se,
upper_CI = coefs + 1.96*se
)
return(out_df)
}
mod1a_coefs <- regressions_1(df_storm, "Unbalanced", "reg1_unbalanced.tex")
regressions_1 <- function (my_df, table_description, table_output){
mod1 <- lm(log(density) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod2 <- lm(log(concentration) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod3 <- lm(log(wealth) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod4 <- lm(log(distribution) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod5 <- lm(log(output) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod6 <- lm(log(use) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod7 <- lm(log(dependence) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod8 <- lm(log(CONT) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod9 <- lm(log(CONT/pop) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
my_models = list(mod1, mod2, mod3, mod4, mod5, mod6, mod7, mod8, mod9)
my_SE <- lapply(my_models, do_the_SE)
stargazer(mod1, mod2, mod3, mod4, mod5, mod6, mod7,mod8, mod9,
title = paste("Hurricane Ike, Canonical DiD---", table_description),
omit = c("factor","Constant"),
se = my_SE,
type = "latex",
order = c(
"treatment:tpost_D",
"treatment",
"tpost_D"
),
font.size = 'footnotesize',
covariate.labels = c(
"Disaster * Post Storm",
"Disaster",
"Post Storm"
),
dep.var.labels = c(
"Density",
"Concentration",
"Wealth",
"Distribution",
"Output",
"Use",
"Dependence",
"Contributions",
"Contrb/Capita"
),
omit.stat = c("rsq", "adj.rsq"),
out = paste("Results/Regression Tables/", table_output, sep=""))
# Main Coefficient Reporting dataframe
model_num <- rep("Model 1", 9)
panel_type <- rep(table_description, 9)
outcome <- c(
"Density",
"Concentration",
"Wealth",
"Distribution",
"Output",
"Use",
"Dependence",
"Contributions",
"Contrb/Capita"
)
main_coefs <- c(
mod1$coefficients["treatment:tpost_D"],
mod2$coefficients["treatment:tpost_D"],
mod3$coefficients["treatment:tpost_D"],
mod4$coefficients["treatment:tpost_D"],
mod5$coefficients["treatment:tpost_D"],
mod6$coefficients["treatment:tpost_D"],
mod7$coefficients["treatment:tpost_D"],
mod8$coefficients["treatment:tpost_D"],
mod9$coefficients["treatment:tpost_D"]
)
term_names <- data.frame(summary(mod1)$aliased)
term_names <- rownames(term_names)
main_se <- lapply(my_SE, function (x) data.frame(term_names, x))
main_se <- bind_rows(main_se)
main_se <- main_se %>%
filter(term_names == "treatment:tpost_D")
main_se <- main_se$x
out_df <- data.frame(model_num, panel_type, outcome, main_coefs, main_se)
colnames(out_df) <- c("model","panel","outcome","coefs","se")
out_df <- out_df %>%
mutate(
lower_CI = coefs - 1.96*se,
upper_CI = coefs + 1.96*se
)
return(out_df)
}
mod1a_coefs <- regressions_1(df_storm, "Unbalanced", "reg1_unbalanced.tex")
mod1b_coefs <- regressions_1(b_df_storm, "Balanced", "reg1_balanced.tex")
View(df_storm)
label = "2001—2013"
my_df = df_storm
moda <- lm(log(CONT) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
modb <- lm(log(CONT/pop) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod1 <- lm(log(density) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod2 <- lm(log(concentration) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod3 <- lm(log(wealth) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod4 <- lm(log(distribution) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod5 <- lm(log(output) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod6 <- lm(log(use) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod7 <- lm(log(dependence) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
my_models = list(moda, modb, mod1, mod2, mod3, mod4, mod5, mod6, mod7)
my_SE <- lapply(my_models, do_the_SE)
# Main Coefficient Reporting dataframe
model_num <- rep(label, 9)
outcome <- c(
"Contributions",
"Contributions per capita",
"Density",
"Concentration",
"Wealth",
"Distribution",
"Output",
"Use",
"Dependence"
)
main_coefs <- c(
moda$coefficients["treatment:tpost_D"],
modb$coefficients["treatment:tpost_D"],
mod1$coefficients["treatment:tpost_D"],
mod2$coefficients["treatment:tpost_D"],
mod3$coefficients["treatment:tpost_D"],
mod4$coefficients["treatment:tpost_D"],
mod5$coefficients["treatment:tpost_D"],
mod6$coefficients["treatment:tpost_D"],
mod7$coefficients["treatment:tpost_D"]
)
term_names <- data.frame(summary(moda)$aliased)
term_names <- rownames(term_names)
main_se <- lapply(my_SE, function (x) data.frame(term_names, x))
View(main_se)
main_se <- bind_rows(main_se)
main_se <- main_se %>%
filter(term_names == "treatment:tpost_D")
View(main_se)
main_se <- main_se$x
colnames(out_df) <- c("model","outcome","coefs","se")
out_df <- data.frame(model_num, outcome, main_coefs, main_se)
colnames(out_df) <- c("model","outcome","coefs","se")
out_df <- out_df %>%
mutate(
lower_CI = coefs - 1.96*se,
upper_CI = coefs + 1.96*se
)
View(out_df)
did_est <- function (my_df, label){
moda <- lm(log(CONT) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
modb <- lm(log(CONT/pop) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod1 <- lm(log(density) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod2 <- lm(log(concentration) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod3 <- lm(log(wealth) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod4 <- lm(log(distribution) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod5 <- lm(log(output) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod6 <- lm(log(use) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
mod7 <- lm(log(dependence) ~ treatment*tpost_D +
as.factor(year) + as.factor(FIPS),
data = my_df)
my_models = list(moda, modb, mod1, mod2, mod3, mod4, mod5, mod6, mod7)
my_SE <- lapply(my_models, do_the_SE)
# Main Coefficient Reporting dataframe
model_num <- rep(label, 9)
outcome <- c(
"Contributions",
"Contributions per capita",
"Density",
"Concentration",
"Wealth",
"Distribution",
"Output",
"Use",
"Dependence"
)
main_coefs <- c(
moda$coefficients["treatment:tpost_D"],
modb$coefficients["treatment:tpost_D"],
mod1$coefficients["treatment:tpost_D"],
mod2$coefficients["treatment:tpost_D"],
mod3$coefficients["treatment:tpost_D"],
mod4$coefficients["treatment:tpost_D"],
mod5$coefficients["treatment:tpost_D"],
mod6$coefficients["treatment:tpost_D"],
mod7$coefficients["treatment:tpost_D"]
)
term_names <- data.frame(summary(moda)$aliased)
term_names <- rownames(term_names)
main_se <- lapply(my_SE, function (x) data.frame(term_names, x))
main_se <- bind_rows(main_se)
main_se <- main_se %>%
filter(term_names == "treatment:tpost_D")
main_se <- main_se$x
out_df <- data.frame(model_num, outcome, main_coefs, main_se)
colnames(out_df) <- c("model","outcome","coefs","se")
return(out_df)
}
tab_est <- list()
tab_est[[1]] = did_est(df_storm %>% filter(year <= 2009), "2001—2009")
tab_est[[2]] = did_est(df_storm %>% filter(year <= 2011), "2001—2011")
tab_est[[3]] = did_est(df_storm %>% filter(year <= 2013), "2001—2013")
tab_est <- bind_rows(tab_est)
View(tab_est)
View(tab_est)
df <- tab_est %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est")
View(df)
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
View(df)
df <- data.frame(lapply(df, function(x) if(is.numeric(x)) round(x, 3) else x))
View(df)
colnames(df) <- c("Outcome", "Stat", "2001—2009", "2001—2011", "2001—2013")
df <- df %>%
mutate(
`2001—2009` = ifelse(
stat == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
stat == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
stat == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
)
)
(22700-20000)/20000
df <- df %>%
mutate(
`2001—2009` = ifelse(
`stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
)
)
df <- df %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
)
)
View(df)
df <- tab_est %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est")
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
df <- data.frame(lapply(df, function(x) if(is.numeric(x)) round(x, 3) else x))
colnames(df) <- c("Outcome", "Stat", "2001—2009", "2001—2011", "2001—2013")
df <- df %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
),
Outcome = ifelse(
`Stat` == "se", "", Outcome
)
)
View(df)
df <- tab_est %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est")
View(df)
View(tab_est)
df <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
df <- df %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est")
View(df)
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
View(df)
df <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
df <- df %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est")
View(df)
df <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
df <- df %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est") %>%
mutate(
sig = ifelse(stat == "se", "", sig),
my_est = paste(round(my_est, 3), sig, sep="")
)
View(df)
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
View(df)
df <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
df <- df %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est") %>%
mutate(
sig = ifelse(stat == "se", "", sig),
my_est = paste(round(my_est, 3), sig, sep="")
) %>%
select(-c(sig))
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
View(df)
colnames(df) <- c("Outcome", "Stat", "2001—2009", "2001—2011", "2001—2013")
df <- df %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
),
Outcome = ifelse(
`Stat` == "se", "", Outcome
)
)
df <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
df <- df %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est") %>%
mutate(
sig = ifelse(stat == "se", "", sig),
my_est = paste(round(my_est, 3), sig, sep="")
) %>%
select(-c(sig))
df <- df %>%
pivot_wider(names_from = "model", values_from = "my_est")
colnames(df) <- c("Outcome", "Stat", "2001—2009", "2001—2011", "2001—2013")
df <- df %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
),
Outcome = ifelse(
`Stat` == "se", "", Outcome
)
) %>%
select(-c(stat))
df <- df %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
),
Outcome = ifelse(
`Stat` == "se", "", Outcome
)
) %>%
select(-c(Stat))
View(df)
tab_est <- tab_est %>%
mutate(
sig = case_when(
coefs/se > 1.645 & coefs/se < 1.96 ~ "*",
coefs/se > 1.96 & coefs/se < 2.326 ~ "**",
coefs/se > 2.326 ~ "***",
T ~ ""
)
)
tab_est <- tab_est %>%
pivot_longer(cols = 3:4, names_to = "stat", values_to = "my_est") %>%
mutate(
sig = ifelse(stat == "se", "", sig),
my_est = paste(round(my_est, 3), sig, sep="")
) %>%
select(-c(sig))
tab_est <- tab_est %>%
pivot_wider(names_from = "model", values_from = "my_est")
colnames(tab_est) <- c("Outcome", "Stat", "2001—2009", "2001—2011", "2001—2013")
tab_est <- tab_est %>%
mutate(
`2001—2009` = ifelse(
`Stat` == "se", paste("(", `2001—2009`, ")", sep=""), as.character(`2001—2009`)
),
`2001—2011` = ifelse(
`Stat` == "se", paste("(", `2001—2011`, ")", sep=""), as.character(`2001—2011`)
),
`2001—2013` = ifelse(
`Stat` == "se", paste("(", `2001—2013`, ")", sep=""), as.character(`2001—2013`)
),
Outcome = ifelse(
`Stat` == "se", "", Outcome
)
) %>%
select(-c(Stat))
View(tab_est)
stargazer(tab_est, summary = F)
stargazer(tab_est, summary = F, rownames = F)
