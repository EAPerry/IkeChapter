#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
slopes(intdid[[1]], variables = "ATT", condition = "log_fixedcont")
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
slopes(intdid[[1]], variables = "ATT", by = "log_fixedcont")
summary(df$log_fixedcont)
summary(df %>% filter(is.finite(log_fixedcont) %>% select(log_fixedcont)))
summary(df %>% filter(is.finite(log_fixedcont) %>% dplyr::select(log_fixedcont)))
summary(df %>% filter(is.finite(log_fixedcont)) %>% dplyr::select(log_fixedcont))
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
avg_slopes(intdid[[1]], variables = "ATT", by = "log_fixedcont")
datagrid(log_fixedcont = c(5, 10, 15, 20),
model = intdid[[1]])
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
delog <- avg_slopes(intdid[[1]], variables = "ATT", by = "log_fixedcont")
View(delog)
ggplot(delog, aes(x = exp(log_fixedcont), y = estimate)) +
geom_line() +
geom_ribbon(aes(ymin = conf.low, ymax=conf.high))
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0)
slp1
View(delog)
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
slopes(intdid[[1]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:3){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
}
slopeest[[1]]
TRUE ~ round((1-exp(estimate))*100,0)))
lapply(slopeest,
mutate(pct = case_when(estimate > 0 ~ round(exp(estimate)*100,0),
TRUE ~ round((1-exp(estimate))*100,0))))
lapply(slopeest,
df %>% mutate(pct = case_when(estimate > 0 ~ round(exp(estimate)*100,0),
TRUE ~ round((1-exp(estimate))*100,0))))
lapply(slopeest,
. %>% mutate(pct = case_when(estimate > 0 ~ round(exp(estimate)*100,0),
TRUE ~ round((1-exp(estimate))*100,0))))
lapply(slopeest,
. %>% mutate(pct = case_when(estimate > 0 ~ round(exp(estimate)*100,0),
TRUE ~ round((1-exp(estimate))*100,0))))
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:3){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = case_when(estimate > 0 ~ round(exp(estimate)*100,0),
TRUE ~ round((1-exp(estimate))*100,0)))
}
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:3){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = case_when(estimate > 0 ~ paste0(round(exp(estimate)*100,0),"%"),
TRUE ~ paste0(round((1-exp(estimate))*100,0),"%")))
}
View(slopeest[[1]])
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
annotate(slopeest[[1]][1,'pct'], x=5, y=slopeest[[1]][1,'estimate']+0.1)
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
annotate(paste0(slopeest[[1]][1,'pct']), x=5, y=slopeest[[1]][1,'estimate']+0.1)
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
annotate(print(slopeest[[1]][1,'pct']), x=5, y=slopeest[[1]][1,'estimate']+0.1)
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct'])
slp1
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct'])
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct'])
slp1
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.05, label = slopeest[[1]][1,'pct'])
slp1
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.05, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2, 'estimate']+0.05, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3, 'estimate']+0.05, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4, 'estimate']+0.05, label = slopeest[[1]][4,'pct'])
slp1
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:3){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = case_when(estimate > 0 ~ paste0(round(exp(estimate)*100,0),"%"),
TRUE ~ paste0("-",round((1-exp(estimate))*100,0),"%")))
}
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5, y=slopeest[[1]][1,'estimate']+0.05, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2, 'estimate']+0.05, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3, 'estimate']+0.05, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4, 'estimate']+0.05, label = slopeest[[1]][4,'pct'])
slp1
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.05, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.05, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.05, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.05, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']+0.05, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']+0.05, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']+0.05, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']+0.05, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[1]][1,'estimate']+0.05, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2,'estimate']+0.05, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3,'estimate']+0.05, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4,'estimate']+0.10, label = slopeest[[1]][4,'pct'])
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.05, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.05, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.05, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.05, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']+1, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']+1, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']+1, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']+1, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2,'estimate']+0.1, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3,'estimate']+0.1, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4,'estimate']+0.1, label = slopeest[[1]][4,'pct'])
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.05, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.05, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.05, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.05, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']-2, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']-2, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']-2, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']-2, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2,'estimate']+0.1, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3,'estimate']+0.1, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4,'estimate']+0.1, label = slopeest[[1]][4,'pct'])
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.1, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.1, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.1, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.1, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']-2, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']-2, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']-2, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']-2, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:2){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
if (i<3){
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = case_when(
estimate > 0 ~ paste0(round(exp(estimate)*100,0),"%"),
TRUE ~ paste0("-",round((1-exp(estimate))*100,0),"%")))
} else {
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = round(estimate,0))
}
}
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2,'estimate']+0.1, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3,'estimate']+0.1, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4,'estimate']+0.1, label = slopeest[[1]][4,'pct'])
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.1, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.1, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.1, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.1, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']-2, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']-2, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']-2, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']-2, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slopesplot
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
# Plot the marginal effects-----------------------------------------------------
#:::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::::
#Automatically uses het robust se because that's built into model estimation
#Extract estimates at specific values of log_fixedcont for graphing
slopeest <- list()
for (i in 1:3){
slopeest[[i]]<- slopes(intdid[[i]], variables = "ATT",
newdata = datagrid(log_fixedcont = c(5, 10, 15, 20)))
if (i<3){
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = case_when(
estimate > 0 ~ paste0(round(exp(estimate)*100,0),"%"),
TRUE ~ paste0("-",round((1-exp(estimate))*100,0),"%")))
} else {
slopeest[[i]] <- slopeest[[i]] %>%
mutate(pct = round(estimate,0))
}
}
slp1 <- plot_slopes(intdid[[1]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Output)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[1]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[1]][1,'estimate']+0.1, label = slopeest[[1]][1,'pct']) +
annotate("text", x=10, y=slopeest[[1]][2,'estimate']+0.1, label = slopeest[[1]][2,'pct']) +
annotate("text", x=15, y=slopeest[[1]][3,'estimate']+0.1, label = slopeest[[1]][3,'pct']) +
annotate("text", x=20, y=slopeest[[1]][4,'estimate']+0.1, label = slopeest[[1]][4,'pct'])
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.1, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.1, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.1, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.1, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']-2, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']-2, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']-2, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']-2, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.1, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.1, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.1, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.05, label = slopeest[[2]][4,'pct'])
slp3 <- plot_slopes(intdid[[3]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in Resource Dependence") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[3]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[3]][1,'estimate']-2, label = slopeest[[3]][1,'pct']) +
annotate("text", x=10, y=slopeest[[3]][2,'estimate']-2, label = slopeest[[3]][2,'pct']) +
annotate("text", x=15, y=slopeest[[3]][3,'estimate']-2, label = slopeest[[3]][3,'pct']) +
annotate("text", x=20, y=slopeest[[3]][4,'estimate']+2, label = slopeest[[3]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
slp2 <- plot_slopes(intdid[[2]],
variables = "ATT",
condition = "log_fixedcont") +
labs(x = "Log of 2007 Contributions",
y = "Average change in log(Density)") +
theme_bw() +
geom_hline(yintercept = 0) +
geom_point(slopeest[[2]], mapping = aes(x=log_fixedcont, y=estimate)) +
annotate("text", x=5,  y=slopeest[[2]][1,'estimate']+0.1, label = slopeest[[2]][1,'pct']) +
annotate("text", x=10, y=slopeest[[2]][2,'estimate']+0.1, label = slopeest[[2]][2,'pct']) +
annotate("text", x=15, y=slopeest[[2]][3,'estimate']+0.1, label = slopeest[[2]][3,'pct']) +
annotate("text", x=20, y=slopeest[[2]][4,'estimate']+0.07, label = slopeest[[2]][4,'pct'])
slopesplot <- ggarrange(slp1, slp2, slp3, nrow = 3)
annotate_figure(slopesplot,
top = text_grob("Average Changes in Nonprofit Indicators Post-Hurricane by Scale of Pre-Disaster GC",
face = "bold", size = 14))
